- rule:
    ID: ec2
    Title: Ensure Multi-Factor Authentication (MFA) is enabled for all IAM users
    Profile Applicability: Level 1
    Description: This check ensures that Multi-Factor Authentication (MFA) is enabled
      for all AWS Identity and Access Management (IAM) users. MFA provides an additional
      layer of security by requiring users to provide a second form of authentication,
      typically a code generated by a mobile app or hardware token.
    Rationale: Enabling MFA for IAM users significantly reduces the risk of unauthorized
      access to AWS resources. If a user's credentials are compromised, the attacker
      would still need access to the second factor of authentication to gain access.
      Without MFA, accounts are more vulnerable to attacks such as phishing and credential
      theft.
    Audit: Use the AWS Management Console, AWS CLI, or AWS SDKs to list all IAM users
      and check if MFA is enabled for each user. Specifically, run the command 'aws
      iam list-users' to retrieve all users, and then 'aws iam list-mfa-devices --user-name
      <user-name>' for each user to verify the presence of MFA devices.
    Default Value: By default, MFA is not enabled for IAM users.
    Remediation: To enable MFA for IAM users, log into the AWS Management Console,
      navigate to the IAM service, select the user, and then choose 'Security credentials'.
      Under 'Assigned MFA device', select 'Manage' and follow the prompts to assign
      a virtual or hardware MFA device.
